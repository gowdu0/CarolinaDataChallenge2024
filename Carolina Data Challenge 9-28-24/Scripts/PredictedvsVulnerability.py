import pandas as pd
import plotly.express as px
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression


csv_file = 'Data\merged_worldbank_demographic_data.csv'
df = pd.read_csv(csv_file)


df.rename(columns={'Aviation Emissions (Tons)': 'Emissions'}, inplace=True)
df['Emissions'] = pd.to_numeric(df['Emissions'], errors='coerce')
df['Climate Vulnerability Score'] = pd.to_numeric(df['Climate Vulnerability Score'], errors='coerce')
df.dropna(inplace=True)


X = df[['GDP (current US$)', 'Population(Thousands)', 'CO2 Emissions (Metric Tons)']]
y = df['Emissions']


X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)


model = LinearRegression()
model.fit(X_train, y_train)


y_pred = model.predict(X_test)

test_results = X_test.copy()
test_results['Predicted Emissions'] = y_pred
test_results['Climate Vulnerability Score'] = df.loc[y_test.index, 'Climate Vulnerability Score']


fig = px.scatter(
    test_results, 
    x='Climate Vulnerability Score', 
    y='Predicted Emissions', 
    labels={
        'Predicted Emissions': 'Predicted Aviation Emissions (Tons)',
        'Climate Vulnerability Score': 'Climate Vulnerability Score',
    },
    title='Predicted Aviation Emissions vs. Climate Vulnerability Score',
    trendline='ols',
    color_continuous_scale='Bluered'
)


fig.show()
